[mysqld]
# 基本设置
user                    = mysql
pid-file                = /var/run/mysqld/mysqld.pid
socket                  = /var/run/mysqld/mysqld.sock
port                    = 3306
basedir                 = /usr
datadir                 = /var/lib/mysql
tmpdir                  = /tmp
lc-messages-dir         = /usr/share/mysql
bind-address            = 127.0.0.1

# 引擎设置
default_storage_engine  = InnoDB
sql_mode                = NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES

# 字符集设置
character-set-server    = {{ mysql_character_set_server }}
collation-server        = {{ mysql_collation_server }}
init-connect            = 'SET NAMES {{ mysql_character_set_server }}'

# 缓存设置
query_cache_size        = {{ mysql_query_cache_size }}
query_cache_type        = {{ mysql_query_cache_type }}
tmp_table_size          = {{ mysql_tmp_table_size }}
max_heap_table_size     = {{ mysql_max_heap_table_size }}

# 连接设置
max_connections         = {{ mysql_max_connections }}
max_allowed_packet      = {{ mysql_max_allowed_packet }}
thread_cache_size       = {{ mysql_thread_cache_size }}
thread_stack            = 256K
interactive_timeout     = 180
wait_timeout            = 180

# 缓冲区设置
join_buffer_size        = {{ mysql_join_buffer_size }}
sort_buffer_size        = {{ mysql_sort_buffer_size }}
read_buffer_size        = {{ mysql_read_buffer_size }}
read_rnd_buffer_size    = {{ mysql_read_rnd_buffer_size }}
myisam_sort_buffer_size = {{ mysql_myisam_sort_buffer_size }}

# 表缓存设置
table_open_cache        = {{ mysql_table_open_cache }}
open_files_limit        = {{ mysql_open_files_limit }}

# InnoDB设置
innodb_buffer_pool_size = {{ mysql_innodb_buffer_pool_size }}
innodb_log_file_size    = {{ mysql_innodb_log_file_size }}
innodb_flush_log_at_trx_commit = 1
innodb_flush_method     = O_DIRECT
innodb_file_per_table   = 1

# 日志设置
log_error               = {{ mysql_log_error }}
slow_query_log          = {{ mysql_slow_query_log }}
slow_query_log_file     = {{ mysql_slow_query_log_file }}
long_query_time         = {{ mysql_long_query_time }}

[client]
default-character-set   = {{ mysql_character_set_server }}

[mysql]
default-character-set   = {{ mysql_character_set_server }}

[mysqldump]
quick
quote-names
max_allowed_packet      = {{ mysql_max_allowed_packet }} 